{  
  "Version":"2012-10-17",
  "Statement":[  
    {
      "Sid":"s3-deny-data-except-from-vpce",
      "Principal":"*",
      "Action": [
        "s3:AbortMultipartUpload",
        "s3:BypassGovernanceRetention",
        "s3:DeleteObject*",
        "s3:GetObject*",
        "s3:ListMultipartUploadParts",
        "s3:ObjectOwnerOverrideToBucketOwner",
        "s3:PutObject*",
        "s3:ReplicateDelete",
        "s3:ReplicateObject",
        "s3:ReplicateTags",
        "s3:RestoreObject"
      ],
      "Effect":"Deny",
      "Resource":[  
        "${s3_bucket_arn}/*"
      ],
      "Condition":{  
        "StringNotLike":{  
          "aws:sourceVpce":[  
            "${source_vpc_endpoint}"
          ]
        }
      }
    }
  ]
}
